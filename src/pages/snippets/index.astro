---
import Layout from "../../layouts/Layout.astro";
import Django from "../../components/icons/Django";

const snippets = await Astro.glob("../**/*.md");

// extract category from frontmatter
const categories = snippets.map((snippet) => snippet.frontmatter.category);

// map categories to icons
const icons: Record<string, any> = {
  django: Django,
};

const categorySnippets = categories.map((category) => {
  const categorySnippets = snippets.filter(
    (snippet) => snippet.frontmatter.category === category
  );

  return {
    title: category,
    icon: icons[category],
    snippets: categorySnippets,
  };
});
---

<Layout title="Snippets">
  <section class="container max-w-2xl pb-10 mx-auto sm:pt-10 sm:pb-40">
    {
      categorySnippets.map((category) => (
        <div>
          <h2 class="flex items-center text-2xl font-bold text-[#092E20] dark:text-gray-100">
            <category.icon />
            <span class="ml-3">{category.title}</span>
          </h2>
          <ul class="mt-4 space-y-4">
            {category.snippets.map((snippet) => (
              <li>
                <a
                  href={snippet.url}
                  class="block p-4 bg-white rounded-lg shadow hover:bg-gray-200 dark:bg-gray-600 dark:hover:bg-gray-700"
                >
                  <h3 class="text-xl font-bold text-gray-900 dark:text-gray-100">
                    {snippet.frontmatter.title}
                  </h3>
                  <p class="mt-2 text-gray-600 dark:text-gray-200">
                    {snippet.frontmatter.description}
                  </p>
                </a>
              </li>
            ))}
          </ul>
        </div>
      ))
    }
  </section>
</Layout>
