---
export const prerender = true;

import Layout from "../../layouts/Layout.astro";
import ExtraHead from "../../components/ExtraHead.astro";
import ExtraFooter from "../../components/ExtraFooter.astro";
import { ghostClient } from "../../lib/ghost";

export async function getStaticPaths() {
  const posts = await ghostClient.posts
    .browse({
      limit: "all",
    })
    .catch((err) => {
      console.error(err);
    });

  if (!posts) return [];

  return posts.map((post) => {
    return {
      params: {
        slug: post.slug,
      },
      props: {
        post: post,
      },
    };
  });
}

const { post } = Astro.props;
---

<Layout
  title={post.title}
  description={post.custom_excerpt ? post.custom_excerpt : ""}
>
  <ExtraHead>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/themes/prism-tomorrow.min.css"
      integrity="sha512-vswe+cgvic/XBoF1OcM/TeJ2FW0OofqAVdCZiEYkd6dwGXthvkSFWOoGGJgS2CW70VK5dQM5Oh+7ne47s74VTg=="
      crossorigin="anonymous"
      referrerPolicy="no-referrer"
    />
  </ExtraHead>
  <article class="mx-auto prose prose-a:link dark:prose-invert">
    <Fragment set:html={post.html} />
  </article>
  <ExtraFooter>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/components/prism-core.min.js"
      integrity="sha512-9khQRAUBYEJDCDVP2yw3LRUQvjJ0Pjx0EShmaQjcHa6AXiOv6qHQu9lCAIR8O+/D8FtaCoJ2c0Tf9Xo7hYH01Q=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/plugins/autoloader/prism-autoloader.min.js"
      integrity="sha512-fTl/qcO1VgvKtOMApX2PdZzkziyr2stM65GYPLGuYMnuMm1z2JLJG6XVU7C/mR+E7xBUqCivykuhlzfqxXBXbg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
  </ExtraFooter>
</Layout>
